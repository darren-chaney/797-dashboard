<!DOCTYPE html>
<html lang="en">
<head>
  <!-- FORCE NO CACHE (DEV) -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <meta charset="UTF-8" />
  <title>Sample Builder (R&D)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- APP VERSION -->
  <meta name="app-version" content="Sample Builder v0.2.1">

  <!-- GLOBAL HEADER CSS -->
  <link rel="stylesheet" href="header.css?v=1.0.0">

  <style>
    :root{
      --bg:#0f172a;
      --panel:#111c33;
      --panel2:#0f1a31;
      --border:#334155;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --good:#22c55e;
      --warn:#f59e0b;
      --btn:#111c33;
      --btn2:#0b1223;
    }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    main{
      max-width:1000px;
      margin:0 auto;
      padding:28px 18px 40px;
    }
    .row{display:flex; gap:14px; flex-wrap:wrap;}
    .panel{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:14px;
      padding:18px;
    }
    .grow{flex:1 1 520px;}
    .side{flex:1 1 320px;}
    label{display:block; color:var(--muted); margin:10px 0 6px;}
    input, select, textarea{
      width:100%;
      background:var(--btn2);
      color:var(--text);
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px;
    }
    .radioRow{display:flex; gap:10px; flex-wrap:wrap;}
    .pill{padding:8px 10px; border:1px solid var(--border); border-radius:10px;}
    .actions{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;}
    button{
      border:1px solid var(--border);
      background:var(--btn2);
      color:var(--text);
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
    }
    button.primary{background:var(--btn);}
    button:disabled{opacity:.5}
    .divider{height:1px; background:var(--border); margin:14px 0;}
    table{width:100%; border-collapse:collapse;}
    th,td{padding:8px; border-bottom:1px solid var(--border);}
    th{background:#0b1223; text-align:left;}
    .badge{padding:6px 10px; border-radius:999px; border:1px solid var(--border);}
    .warn{color:#fcd34d;}
    .muted{color:var(--muted);}
  </style>
</head>

<body>

<div id="global-header"></div>

<main>
  <h1>Sample Builder (R&D)</h1>
  <p class="muted">Create tasting samples up to 375 mL. R&D only.</p>

  <div class="row">
    <!-- INPUT -->
    <section class="panel grow">
      <h2>Sample Inputs</h2>

      <label>Sample Size</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="sampleSize" value="100"> 100 mL</label>
        <label class="pill"><input type="radio" name="sampleSize" value="250" checked> 250 mL</label>
        <label class="pill"><input type="radio" name="sampleSize" value="375"> 375 mL</label>
      </div>

      <label>Base Spirit Type</label>
      <select id="baseSpiritType">
        <option>Moonshine</option>
        <option>Vodka</option>
        <option>Rum</option>
      </select>

      <label>Base Spirit Proof</label>
      <input id="baseProof" type="number" value="155">

      <label>Target Sample Proof</label>
      <input id="targetProof" type="number" value="60">

      <label>Flavor Concept</label>
      <input id="flavorConcept" type="text" placeholder="Strawberry Cream">

      <label>Flavor Strength</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="strength" value="Mild"> Mild</label>
        <label class="pill"><input type="radio" name="strength" value="Strong" checked> Strong</label>
        <label class="pill"><input type="radio" name="strength" value="Extreme"> Extreme</label>
      </div>

      <label>Sweetness (HFCS-42)</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="sweetness" value="none"> None</label>
        <label class="pill"><input type="radio" name="sweetness" value="10"> 10%</label>
        <label class="pill"><input type="radio" name="sweetness" value="12" checked> 12%</label>
        <label class="pill"><input type="radio" name="sweetness" value="14"> 14%</label>
      </div>

      <div class="actions">
        <button class="primary" id="btnGenerate">Generate Starting Sample</button>
        <button id="btnClear">Clear</button>
        <span id="inputWarning" class="badge muted" style="display:none;"></span>
      </div>
    </section>

    <!-- SIDE -->
    <aside class="panel side">
      <h2>Drafts</h2>
      <div id="draftList" class="muted">No drafts yet.</div>

      <div class="actions">
        <button id="btnSaveDraft" disabled>Save Draft</button>
        <button id="btnLoadLast">Load Last</button>
      </div>

      <div class="actions">
        <button id="btnExportDraft" disabled>Export Draft</button>
        <button id="btnExportRecipes">Export Candidate Recipes</button>
      </div>
    </aside>
  </div>

  <!-- OUTPUT -->
  <section class="panel" id="outputPanel" style="display:none; margin-top:14px;">
    <h2>Generated Sample</h2>
    <div id="sampleMeta" class="muted"></div>

    <div id="warningBlock" class="warn"></div>

    <table id="ingredientTable">
      <thead>
        <tr>
          <th>Component</th>
          <th>mL</th>
          <th>L</th>
          <th>g / kg</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="actions">
      <button id="btnDuplicate" disabled>Duplicate & Adjust</button>
      <button id="btnPromote" disabled class="primary">Save as Candidate Base Recipe</button>
    </div>
  </section>
</main>

<!-- PROMOTION MODAL -->
<div id="promoBackdrop" style="display:none;">
  <div class="panel">
    <h3>Save as Candidate Base Recipe</h3>

    <label>Recipe Name</label>
    <input id="promoRecipeName">

    <label>Internal Notes</label>
    <textarea id="promoNotes"></textarea>

    <label><input type="checkbox" id="chkTasted"> Tasted at 375 mL</label>
    <label><input type="checkbox" id="chkBalanced"> Balanced</label>
    <label><input type="checkbox" id="chkUnderstood"> Understands candidate only</label>

    <div class="actions">
      <button id="btnCancelPromo">Cancel</button>
      <button id="btnConfirmPromo" class="primary">Confirm</button>
    </div>

    <div id="promoError" class="warn"></div>
  </div>
</div>

<!-- HEADER -->
<script>
  fetch("header.html",{cache:"no-store"})
    .then(r=>r.text())
    .then(h=>document.getElementById("global-header").innerHTML=h);
</script>

<!-- APP SCRIPTS -->
<script src="logic.js?v=SB_0.2.0"></script>
<script src="ui.js?v=SB_0.2.0"></script>

</body>
</html>
