<!DOCTYPE html>
<html lang="en">
<head>
  <script src="auth.js"></script>
  <script src="bootstrap.js"></script>
  <!-- FORCE NO CACHE (DEV) -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <meta charset="UTF-8" />
  <title>Sample Builder (R&D)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- APP VERSION -->
  <meta name="app-version" content="Sample Builder v0.3.0">

  <!-- GLOBAL HEADER CSS -->
  <link rel="stylesheet" href="header.css?v=1.0.0">

  <style>
    :root{
      --bg:#0f172a;
      --panel:#111c33;
      --border:#334155;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --good:#22c55e;
      --warn:#f59e0b;
      --btn:#111c33;
      --btn2:#0b1223;
    }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    main{
      max-width:1100px;
      margin:0 auto;
      padding:28px 18px 40px;
    }
    .row{display:flex; gap:14px; flex-wrap:wrap;}
    .panel{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:14px;
      padding:18px;
    }
    .grow{flex:1 1 520px;}
    .side{flex:1 1 320px;}
    label{display:block; color:var(--muted); margin:10px 0 6px;}
    input, select, textarea{
      width:100%;
      background:var(--btn2);
      color:var(--text);
      border:1px solid var(--border);
      border-radius:10px;
      padding:8px;
    }
    input[readonly]{
      opacity:.6;
      cursor:not-allowed;
    }
    .radioRow{display:flex; gap:10px; flex-wrap:wrap;}
    .pill{padding:8px 10px; border:1px solid var(--border); border-radius:10px;}
    .actions{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;}
    button{
      border:1px solid var(--border);
      background:var(--btn2);
      color:var(--text);
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
    }
    button.primary{background:var(--btn);}
    button:disabled{opacity:.5}
    .divider{height:1px; background:var(--border); margin:14px 0;}
    table{width:100%; border-collapse:collapse;}
    th,td{padding:8px; border-bottom:1px solid var(--border);}
    th{background:#0b1223; text-align:left;}
    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      display:inline-block;
      margin-left:10px;
    }
    .badge.adjusted{color:#fcd34d;}
    .muted{color:var(--muted);}
        /* ============================================================
       Sample Composition Table – Readability Enhancements
       (Scoped to Sample Builder only)
       ============================================================ */

    /* Allow component names to wrap and breathe */
    #ingredientTable td:first-child {
      max-width: 280px;
      white-space: normal;
      line-height: 1.25;
      vertical-align: top;
    }

    /* Slightly more vertical space for rows */
    #ingredientTable td,
    #ingredientTable th {
      padding-top: 10px;
      padding-bottom: 10px;
    }

    /* Suggested column = reference only */
    #ingredientTable td:nth-child(2) {
      color: var(--muted);
    }

    /* Adjusted inputs stand out as active */
    #ingredientTable input.adjust-input {
      background: var(--btn2);
      border-color: #475569;
    }

    /* Stabilize numeric column widths */
    #ingredientTable th:nth-child(2),
    #ingredientTable td:nth-child(2),
    #ingredientTable th:nth-child(3),
    #ingredientTable td:nth-child(3) {
      width: 110px;
    }

    #ingredientTable th:nth-child(4),
    #ingredientTable td:nth-child(4) {
      width: 60px;
      text-align: center;
    }

    /* Notes column flexes last */
    #ingredientTable th:nth-child(5),
    #ingredientTable td:nth-child(5) {
      width: auto;
      white-space: nowrap;
    }

    /* De-emphasize delete button */
    #ingredientTable button[data-del] {
      background: transparent;
      border: 1px solid var(--border);
      color: #64748b;
      font-size: 0.85rem;
      padding: 2px 6px;
      border-radius: 6px;
    }

    #ingredientTable button[data-del]:hover {
      color: var(--text);
      border-color: #64748b;
      background: #1e293b;
    }

  </style>
</head>

<body>

<div id="global-header"></div>

<main>
  <h1>Sample Builder (R&D)</h1>
  <p class="muted">
    Create tasting samples up to 375 mL. R&D only.
    <span id="adjustedBadge" class="badge adjusted" style="display:none;">Adjusted Sample</span>
  </p>

  <div class="row">
    <!-- INPUT -->
    <section class="panel grow">
      <h2>Sample Inputs</h2>

      <label>Sample Size</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="sampleSize" value="100"> 100 mL</label>
        <label class="pill"><input type="radio" name="sampleSize" value="250" checked> 250 mL</label>
        <label class="pill"><input type="radio" name="sampleSize" value="375"> 375 mL</label>
      </div>

      <label>Base Spirit Type</label>
      <select id="baseSpiritType">
        <option>Moonshine</option>
        <option>Vodka</option>
        <option>Rum</option>
      </select>

      <label>Base Spirit Proof</label>
      <input id="baseProof" type="number" value="155">

      <label>Target Sample Proof</label>
      <input id="targetProof" type="number" value="60">

      <label>Flavor Concept</label>
      <input id="flavorConcept" type="text" placeholder="Banana Cream">

      <label>Flavor Strength</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="strength" value="Mild"> Mild</label>
        <label class="pill"><input type="radio" name="strength" value="Strong" checked> Strong</label>
        <label class="pill"><input type="radio" name="strength" value="Extreme"> Extreme</label>
      </div>

      <label>Sweetness (HFCS-42)</label>
      <div class="radioRow">
        <label class="pill"><input type="radio" name="sweetness" value="none"> None</label>
        <label class="pill"><input type="radio" name="sweetness" value="10"> 10%</label>
        <label class="pill"><input type="radio" name="sweetness" value="12" checked> 12%</label>
        <label class="pill"><input type="radio" name="sweetness" value="14"> 14%</label>
      </div>

      <div class="actions">
        <button class="primary" id="btnGenerate">Generate Starting Sample</button>
        <button id="btnClear">Clear</button>
        <span id="inputWarning" class="badge muted" style="display:none;"></span>
      </div>
    </section>

    <!-- SIDE -->
    <aside class="panel side">
      <h2>Saved Samples</h2>
      <div id="draftList" class="muted">No samples yet.</div>

      <div class="actions">
        <button id="btnSaveDraft" disabled>Save Sample</button>
        <button id="btnLoadLast">Load Last</button>
      </div>
    </aside>
  </div>

  <!-- OUTPUT -->
  <section class="panel" id="outputPanel" style="display:none; margin-top:14px;">
    <h2>Sample Composition</h2>
    <div id="sampleMeta" class="muted"></div>

    <table id="ingredientTable">
      <thead>
        <tr>
          <th>Component</th>
          <th>Suggested (mL)</th>
          <th>Adjusted (mL)</th>
          <th>Δ</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="actions">
      <button id="btnDuplicate" disabled>Duplicate & Adjust</button>
    </div>
  </section>
</main>

<!-- HEADER -->
<script>
  fetch("header.html",{cache:"no-store"})
    .then(r=>r.text())
    .then(h=>document.getElementById("global-header").innerHTML=h);
</script>

<!-- APP SCRIPTS -->
<script src="logic.js?v=SB_0.3.0"></script>
<script src="ui.js?v=SB_0.3.0"></script>

</body>
</html>
